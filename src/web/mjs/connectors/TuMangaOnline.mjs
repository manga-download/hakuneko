import Connector from '../engine/Connector.mjs';

export default class TuMangaOnline extends Connector {

    constructor() {
        super();
        super.id = 'tumangaonline';
        super.label = 'TuMangaOnline';
        this.tags = [ 'manga', 'spanish' ];
        this.url = 'https://tmofans.com';
        this.requestOptions.headers.set('x-referer', this.url);
    }

    async _initializeConnector() {
        await super._initializeConnector();
        await this.wait(2500);
    }

    async _getMangas() {
        let request = new Request('http://cdn.hakuneko.download/' + this.id + '/mangas.json', this.requestOptions);
        let response = await fetch(request);
        return await response.json();
    }

    async _getChapters(manga) {
        let script = `
            var _0x2859=['YkvDlG58w5PCpMOKLsKMTWdJwphfEsOvw7M2woDCnsKTwpPCjMOKTcOrexrDrcKAwqBVwqhHw7HDi8OAw6LCtQPCr1UBwrsX','dcOFdBsC','VCjCun3CgMKUHMK6wq8b','YX7CiMOMPQ==','UxfCplIMw7tcMsKBMhwNw6zCisKBHHtdLMKvAcO7w5zDpsKNAsOhw4PCm2tRw48Lw6A4w7XCtwzCu0bDkcKKVkrCjBQxw70fAcKiJcKUw5B5S8OVJ8Kywq9ow6bCtS/CosOaw68=','IVlNw7Nk','w4drBMO3AsOhNhfCvw==','LHcBdsKC','w4pOY2MAVWY8URVswpnCpsKiDhcwwoYQJADCisKLNAJlw6nCmgnDmGTDtsKnw6jDmhjDi0tgP8Oew5VqMwnCtkxMwrDCg8OFw7U8bsOzw6vDr8OvwrI=','GFkOwrl5','w7LDun8oeg==','LEZPw4hK','w4hnwqUOKA==','AHpOw4NN','w6Fkw6gcwpE=','QcKATEnDlg==','Y1PCvA==','VBbCuRALw6FYLA==','w7bDl3LCii8=','K0dww4pEIFk=','wr/DhsK5cA/DuTMww53DnmEsd3k=','asKWc0s=','ADbDrxk=','JT8Kw64=','SC/CkmPCpg==','csOwaMORw6E=','dcOteQ4H','a0PDkg==','Uy7Co2c=','w77DmMKTVw==','VnXDisOldg==','XVTDiMOqZQ==','ccKLNMKhLw==','L2oR','ZMKBeX7DgyHCqFXDqg==','w73Dn3TCmjM=','a8KNw4XDpiocGcOaRMKZMMKCUjJfVUrDjw==','FsKcw4vCjSs=','w6Z2RDcP','wpzChyUDYjg=','w7ZXwpcJ','fH/ClcOCAA==','WcOjNDMO','wpTCjxsVfQ==','wpvDvsKzbgI=','w6/Dk28zQg==','WiQ4YMKd','w6VPK8O/Eg==','bxrCimnCgA==','w4dOL1fCt8Oi','WAVWwqlW','Olk9esKD'];(function(_0x83fbe8,_0x37b083){var _0xb462be=function(_0x3bc219){while(--_0x3bc219){_0x83fbe8['push'](_0x83fbe8['shift']());}};_0xb462be(++_0x37b083);}(_0x2859,0x100));var _0x3302=function(_0x83fbe8,_0x37b083){_0x83fbe8=_0x83fbe8-0x0;var _0xb462be=_0x2859[_0x83fbe8];if(_0x3302['BUhwwg']===undefined){(function(){var _0x398d70;try{var _0x4552c3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x398d70=_0x4552c3();}catch(_0xd20d7a){_0x398d70=window;}var _0x22fa2b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x398d70['atob']||(_0x398d70['atob']=function(_0x1ba942){var _0x4e5a6f=String(_0x1ba942)['replace'](/=+$/,'');for(var _0x5c2481=0x0,_0x1d0821,_0xb0b0b5,_0x551bf9=0x0,_0x44ce65='';_0xb0b0b5=_0x4e5a6f['charAt'](_0x551bf9++);~_0xb0b0b5&&(_0x1d0821=_0x5c2481%0x4?_0x1d0821*0x40+_0xb0b0b5:_0xb0b0b5,_0x5c2481++%0x4)?_0x44ce65+=String['fromCharCode'](0xff&_0x1d0821>>(-0x2*_0x5c2481&0x6)):0x0){_0xb0b0b5=_0x22fa2b['indexOf'](_0xb0b0b5);}return _0x44ce65;});}());var _0x502a37=function(_0x3861c8,_0x37b083){var _0x1b5440=[],_0x559ada=0x0,_0x1dfff4,_0x5e4b69='',_0x3c5443='';_0x3861c8=atob(_0x3861c8);for(var _0x5070d4=0x0,_0x6c6ec3=_0x3861c8['length'];_0x5070d4<_0x6c6ec3;_0x5070d4++){_0x3c5443+='%'+('00'+_0x3861c8['charCodeAt'](_0x5070d4)['toString'](0x10))['slice'](-0x2);}_0x3861c8=decodeURIComponent(_0x3c5443);for(var _0x3f43e3=0x0;_0x3f43e3<0x100;_0x3f43e3++){_0x1b5440[_0x3f43e3]=_0x3f43e3;}for(_0x3f43e3=0x0;_0x3f43e3<0x100;_0x3f43e3++){_0x559ada=(_0x559ada+_0x1b5440[_0x3f43e3]+_0x37b083['charCodeAt'](_0x3f43e3%_0x37b083['length']))%0x100;_0x1dfff4=_0x1b5440[_0x3f43e3];_0x1b5440[_0x3f43e3]=_0x1b5440[_0x559ada];_0x1b5440[_0x559ada]=_0x1dfff4;}_0x3f43e3=0x0;_0x559ada=0x0;for(var _0x365565=0x0;_0x365565<_0x3861c8['length'];_0x365565++){_0x3f43e3=(_0x3f43e3+0x1)%0x100;_0x559ada=(_0x559ada+_0x1b5440[_0x3f43e3])%0x100;_0x1dfff4=_0x1b5440[_0x3f43e3];_0x1b5440[_0x3f43e3]=_0x1b5440[_0x559ada];_0x1b5440[_0x559ada]=_0x1dfff4;_0x5e4b69+=String['fromCharCode'](_0x3861c8['charCodeAt'](_0x365565)^_0x1b5440[(_0x1b5440[_0x3f43e3]+_0x1b5440[_0x559ada])%0x100]);}return _0x5e4b69;};_0x3302['diBNcR']=_0x502a37;_0x3302['wGKYTl']={};_0x3302['BUhwwg']=!![];}var _0x28588d=_0x3302['wGKYTl'][_0x83fbe8];if(_0x28588d===undefined){if(_0x3302['xrzNyu']===undefined){_0x3302['xrzNyu']=!![];}_0xb462be=_0x3302['diBNcR'](_0xb462be,_0x37b083);_0x3302['wGKYTl'][_0x83fbe8]=_0xb462be;}else{_0xb462be=_0x28588d;}return _0xb462be;};new Promise(_0x5a50f5=>{var _0x3b03ee={};_0x3b03ee[_0x3302('0x0','[8%W')]=_0x3302('0x1','raj5');_0x3b03ee[_0x3302('0x2','QF&J')]=function(_0x59f878,_0x439d4c){return _0x59f878(_0x439d4c);};_0x3b03ee[_0x3302('0x3','6)S1')]=_0x3302('0x4',']ZUE');_0x3b03ee[_0x3302('0x5','MdOT')]=_0x3302('0x6','[8%W');_0x3b03ee[_0x3302('0x7','(X#v')]=_0x3302('0x8','r3VQ');_0x3b03ee[_0x3302('0x9','](Oz')]=_0x3302('0xa','2zmH');_0x3b03ee[_0x3302('0xb','tJqQ')]=_0x3302('0xc','yItd');_0x3b03ee[_0x3302('0xd','&6uA')]=function(_0x2e75ce,_0x4adfca){return _0x2e75ce<_0x4adfca;};_0x3b03ee[_0x3302('0xe','lo&X')]=function(_0x341705,_0x4b9f40){return _0x341705+_0x4b9f40;};_0x3b03ee[_0x3302('0xf','](Oz')]=function(_0x5d9458,_0x96a00b){return _0x5d9458+_0x96a00b;};_0x3b03ee[_0x3302('0x10','U!fX')]=function(_0x25cd97,_0xacf198,_0x4fe844){return _0x25cd97(_0xacf198,_0x4fe844);};let _0x2cf5c4={};_0x2cf5c4[_0x3b03ee[_0x3302('0x11','](Oz')]]=[..._0x3b03ee[_0x3302('0x12','4$MV')]($,_0x3b03ee[_0x3302('0x13','0L3t')])][_0x3302('0x14','(X#v')](_0x358880=>$(_0x358880)[_0x3302('0x15','r3VQ')]()[_0x3302('0x16','nYbG')]()[_0x3302('0x17','](Oz')](_0x3302('0x18','B&I$'))[_0x3302('0x19','UBaF')]('h4')[_0x3302('0x1a','lTkR')]()[_0x3302('0x1b','Hvkl')]());_0x2cf5c4[_0x3b03ee[_0x3302('0x1c','[8%W')]]=[..._0x3b03ee[_0x3302('0x1d','CV*J')]($,_0x3b03ee[_0x3302('0x1e','MdOT')])][_0x3302('0x1f',']ZUE')](_0x10d764=>_0x10d764[_0x3302('0x20','[8%W')][_0x3302('0x21','wkl[')]());_0x2cf5c4[_0x3b03ee[_0x3302('0x22','qI5)')]]=[..._0x3b03ee[_0x3302('0x23','qI5)')]($,_0x3b03ee[_0x3302('0x24','MN90')])][_0x3302('0x25','&6uA')](_0x89bf15=>_0x89bf15[_0x3302('0x26','0L3t')][_0x3302('0x27','nYbG')](new RegExp(_0x3302('0x28','vZKt')))[0x1]);let _0xb2a490=[];for(let _0x72a863=0x0;_0x3b03ee[_0x3302('0x29','emk7')](_0x72a863,_0x2cf5c4[_0x3b03ee[_0x3302('0x2a','yItd')]][_0x3302('0x2b','%X&a')]);_0x72a863++){_0xb2a490[_0x3302('0x2c','U!fX')]({'id':_0x72a863,'title':_0x3b03ee[_0x3302('0x2d','(X#v')](_0x3b03ee[_0x3302('0x2e',']8M[')](_0x3b03ee[_0x3302('0x2f','%X&a')](_0x2cf5c4[_0x3b03ee[_0x3302('0x30','B&I$')]][_0x72a863],'\x20['),_0x2cf5c4[_0x3b03ee[_0x3302('0x31','lo&X')]][_0x72a863]),']'),'language':_0x2cf5c4[_0x3b03ee[_0x3302('0x32','2sRz')]][_0x72a863]});}_0x3b03ee[_0x3302('0x33','2zmH')](setTimeout,()=>_0x5a50f5(_0xb2a490),0x9c4);});
        `;
        let request = new Request(this.url + manga.id, this.requestOptions);
        return await Engine.Request.fetchUI(request, script);
    }

    async _getChapterLink(chapter) {
        let script = `
            window['chapter'] = ${chapter.id};
            var _0xd800=['K8O8FEPDmhJQYMOiwrTDlcOlwqpDwoUSPhPCsxXCgVVBw5JGKMKFwptOw6XCk2lZIEnChsKjVTPCscOZwrHCqQDDqURAwoQ=','BhbDgg4sw4U2','wqZMeiTDjg==','w6rDtcO8w4xQ','N3DDocOFZA==','w44Qw7HCkcKuO8KAIyY=','XMKyw6FWwoA=','w7FOYVzCj8OdCA==','wrPCgFjDhUc=','wqnDqT1uFQDCjAkjTA==','d3LDozFr','wr7Cp1rDgQ==','w4wSw586','w40Vwr3Dvmc=','w613wq4=','wrLCrFlpwoTDnMOaKQ==','woIoBC/DkQ==','SHfDiTVeHsKv','Ti5gwrDCnA==','wq3CqEvDlcOKw5/DnQ==','w7gywpDCgTg=','w57Cr8O4wrhl','IMOKL0pA','w4FcwoYAZg==','FMOMw6rCj8Od','dDxtw7YU'];(function(_0x1498c4,_0x2b4259){var _0x4d60fb=function(_0x1aa56d){while(--_0x1aa56d){_0x1498c4['push'](_0x1498c4['shift']());}};_0x4d60fb(++_0x2b4259);}(_0xd800,0x155));var _0x1204=function(_0x1498c4,_0x2b4259){_0x1498c4=_0x1498c4-0x0;var _0x4d60fb=_0xd800[_0x1498c4];if(_0x1204['SmeXDI']===undefined){(function(){var _0x3d53a6=function(){var _0x4b3955;try{_0x4b3955=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x55efe3){_0x4b3955=window;}return _0x4b3955;};var _0x444060=_0x3d53a6();var _0x2fca36='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x444060['atob']||(_0x444060['atob']=function(_0x123adf){var _0x265906=String(_0x123adf)['replace'](/=+$/,'');for(var _0x513385=0x0,_0x58f5bf,_0x2dc233,_0x12e041=0x0,_0x3194f6='';_0x2dc233=_0x265906['charAt'](_0x12e041++);~_0x2dc233&&(_0x58f5bf=_0x513385%0x4?_0x58f5bf*0x40+_0x2dc233:_0x2dc233,_0x513385++%0x4)?_0x3194f6+=String['fromCharCode'](0xff&_0x58f5bf>>(-0x2*_0x513385&0x6)):0x0){_0x2dc233=_0x2fca36['indexOf'](_0x2dc233);}return _0x3194f6;});}());var _0x552479=function(_0x3e8fd4,_0x2b4259){var _0x393bfa=[],_0x2f5977=0x0,_0x5ddee6,_0x551ddb='',_0xa2774e='';_0x3e8fd4=atob(_0x3e8fd4);for(var _0x596e63=0x0,_0x4f2063=_0x3e8fd4['length'];_0x596e63<_0x4f2063;_0x596e63++){_0xa2774e+='%'+('00'+_0x3e8fd4['charCodeAt'](_0x596e63)['toString'](0x10))['slice'](-0x2);}_0x3e8fd4=decodeURIComponent(_0xa2774e);for(var _0x3ed637=0x0;_0x3ed637<0x100;_0x3ed637++){_0x393bfa[_0x3ed637]=_0x3ed637;}for(_0x3ed637=0x0;_0x3ed637<0x100;_0x3ed637++){_0x2f5977=(_0x2f5977+_0x393bfa[_0x3ed637]+_0x2b4259['charCodeAt'](_0x3ed637%_0x2b4259['length']))%0x100;_0x5ddee6=_0x393bfa[_0x3ed637];_0x393bfa[_0x3ed637]=_0x393bfa[_0x2f5977];_0x393bfa[_0x2f5977]=_0x5ddee6;}_0x3ed637=0x0;_0x2f5977=0x0;for(var _0x1ff12f=0x0;_0x1ff12f<_0x3e8fd4['length'];_0x1ff12f++){_0x3ed637=(_0x3ed637+0x1)%0x100;_0x2f5977=(_0x2f5977+_0x393bfa[_0x3ed637])%0x100;_0x5ddee6=_0x393bfa[_0x3ed637];_0x393bfa[_0x3ed637]=_0x393bfa[_0x2f5977];_0x393bfa[_0x2f5977]=_0x5ddee6;_0x551ddb+=String['fromCharCode'](_0x3e8fd4['charCodeAt'](_0x1ff12f)^_0x393bfa[(_0x393bfa[_0x3ed637]+_0x393bfa[_0x2f5977])%0x100]);}return _0x551ddb;};_0x1204['agDNEQ']=_0x552479;_0x1204['RiKNMv']={};_0x1204['SmeXDI']=!![];}var _0x1e98bc=_0x1204['RiKNMv'][_0x1498c4];if(_0x1e98bc===undefined){if(_0x1204['YiWJuV']===undefined){_0x1204['YiWJuV']=!![];}_0x4d60fb=_0x1204['agDNEQ'](_0x4d60fb,_0x2b4259);_0x1204['RiKNMv'][_0x1498c4]=_0x4d60fb;}else{_0x4d60fb=_0x1e98bc;}return _0x4d60fb;};new Promise((_0x394917,_0xae9ad7)=>{var _0x425549={};_0x425549[_0x1204('0x0','gN^&')]=function(_0x4a26a3,_0x37d0e6){return _0x4a26a3(_0x37d0e6);};_0x425549[_0x1204('0x1','wn))')]=_0x1204('0x2','G&#Q');_0x425549[_0x1204('0x3','U]FM')]=_0x1204('0x4','f7jL');_0x425549[_0x1204('0x5','nqQd')]=_0x1204('0x6','V6e0');_0x425549[_0x1204('0x7','7IS1')]=function(_0xcf194d,_0x28b129,_0x52ef9c){return _0xcf194d(_0x28b129,_0x52ef9c);};let _0x2170e8=$[_0x1204('0x8','%WIS')];$[_0x1204('0x9','smEq')]=_0x3d30c6=>{var _0x1947d3={};_0x1947d3[_0x1204('0xa','*JoM')]=function(_0x5a7cd3,_0x7ce01b){return _0x425549.DOeTM(_0x5a7cd3,_0x7ce01b);};if(_0x3d30c6[_0x1204('0xb','sCfE')][_0x1204('0xc','u&cR')](_0x425549[_0x1204('0xd','0pc$')])){_0x3d30c6[_0x1204('0xe','7IS1')]=_0x174601=>{_0x425549[_0x1204('0xf','*9Wy')](_0x394917,_0x174601[_0x1204('0x10','%WIS')](_0x425549[_0x1204('0x11',')diG')],_0x425549[_0x1204('0x12','bfVG')]));};_0x3d30c6[_0x1204('0x13','5C*3')]=(_0x23e1ca,_0x4ff958,_0x952953)=>{_0x1947d3[_0x1204('0x14','sCfE')](_0xae9ad7,_0x952953);};}_0x425549[_0x1204('0x15','x0cD')](_0x2170e8,_0x3d30c6);};_0x425549[_0x1204('0x16','8ZSL')](setTimeout,()=>$(_0x1204('0x17','@a3p'))[window[_0x1204('0x18','nKM1')]][_0x1204('0x19','5sE1')](),0x3e8);});
        `;
        let request = new Request(this.url + chapter.manga.id, this.requestOptions);
        let data = await Engine.Request.fetchUI(request, script);
        return new URL(data, request.url);
    }

    async _getPages(chapter) {
        let script = `
            const _0x27fc=['w6rCmMO5Pjs=','wq7Cv8KibMOA','w6o8woI6w7Q=','fgPCscK7XA==','w4JsfcOuZA==','wrEZw7UWCA==','w5U1w6Bsw5k=','JcOdwqoGwrI=','LsKQM8Oswrw=','wo8nw5UeFQ==','W8KcwqzDmzY=','w645w53DqXQ=','DAhqw7jCjg==','egRnwpsx','GlM+Iig=','w78Xwqo5w5U=','acKjwp7DqT0=','ewXDhUQE','w4ANwq4Mw6E=','w6HCksOaHgo=','aRTCiQF8','w4Afwpsww6o=','wpcYdsOdMQ==','ZBJ2wqQZ','wprDuW3DlMKm','w4Fpw61Nw5Buw6DCn0A=','wrYpw64aKw==','BMK+T8Opw5k=','w7XDmjISLw==','w5U6OUfCgETCqW82','w6suwqoLw4U=','KhJ1w5nCmw==','w5NGQsONaQ==','FEQICzA=','w6gfwpDDpQs=','RsKFw6dVw58=','Y8KFwpHDg8Ka','w5s9KlbCnA==','w7BgecONew==','wq88w7cC','w5tbXsOfag==','w6cnw6zDlVs=','w6o1wpXDki4=','agZ0woEd','w4LDiGRsJg==','w7LDniQmAw==','w4/DowsYOA==','QMOwSA==','Tx/CpQ==','Gl8qYGk=','bUtsHyg=','cAgX','wq40w4w0BQ==','w4DDuF9SEA==','w6NDZMOJSw==','HsK9IcOSwrY=','w5LClXRNQG9Owox0D8KbPA==','QzrCkHvDlg==','w6J8AA==','w6nDtcOvNwk=','K37Dqx/DkcK1NsKBV0rDmsOo','wqkGw5snKQ==','w5HCmXN8VW9fwo1TDMKKNwQ=','w4g8wrLDohI=','wp3DssKJw50DSnvCt8KlRzw=','fMORYAvCpQ==','w6jDg095','WQ3Ck0DDtg==','w6nCl8Oaw6TCoA==','XwHCr8KUQMKbwrIRO8KxSw==','wqkiYsOuKQ==','w41zw6Faw5h2w4fCjXHCrcKhw6Y=','wqTDvkvDsMKc','w58dwok5Jw==','WyzDh3Umwr/CvA==','w6IHHXjCvw==','wrUyw6wJM3nDm3zDgsORKgQR','RCU1W1A=','w64kwpMtw4I=','w51lw7hJw4A=','w5Yuw6xBw6nCnQ==','w6TCrsK3woxg','N8KZQ8Ojw7s=','w6PDkD0cWg==','VifCsMKSYQ==','XsKITkbCnw==','JGMkNzPDnxNQOQ==','IUkGNAg=','wqAawpTDpg3Ct0NqShbDisKkw7NRwqTDlmU9wrB/RA==','WwnCrcKoeQ==','HcO0QhzCocOSw7TDsksdwr/DlkjCrcOtWhvDrsOJdiY=','w582w75Gw7Y=','RnzClDEOw6zCil3DhcOjPcObw6TCgMO0ARh4JA==','wqHDncKMVMOY','woPDhAoWcMOiw6TCosK9Z8OAwoDCg8OCBF9kwpIH','MGzDpSzDrA==','wozCmMKn','K1MiAi4=','w7EkwoptwolRwqc=','w7zDiGVoFA==','w7NLZMOIS2s=','TwDCt8KDTQ==','wqQOR8OvCw==','WT3Dlg==','cx3CqyB0','VgxNwpEw','NsK9MsO+wpIp','f8OKWjLCug==','McOuwpsowp/DtsO2H8KRw6JIw6xzwoY=','wrc7w4YrGg==','Q8OwRA3CucODw7/Cr00=','wpPDkcKId8OH','dR7CjEvDsQ==','w7fDj1x0ES7CgsOPwr3DlC3ClXvDqcOcwqk5woAew5MZRgLDocKTwoDDpsKGAsKyw7lDVknDiMK6VMKZEx/CoA==','wqLDrsOlKcOX','PW3DvjI=','X2h9CwI=','w6zDm8OuEw==','w7k8wpI3Og==','w4kuw6ZBw6PChA==','w47DmGVvKQ==','w7E6wrQYw4HCp8OTCsKVwrt8','w5AqGnbCvw==','w4luP27CrsO6wqNmWx5Kw6PDuFFqFg==','ATRkw73CnA==','w54jP0DCi03CqGw=','w6c2w47DiEs=','w40kw7pKw6DCnw==','wqw0W8OWAw==','w4l6w7w=','w6rCosO6FBI=','DlAiW00=','wovDssO6KsOw','w57DjB8=','wo3DiMO8L8Oz','w74bw6/Dt0E=','w5rDkMOhLSg=','w6LCgcOvw6vCsg==','LcKDWMOuw7U=','w4ADw53DlWE='];(function(_0xdf08c8,_0x469a01){const _0xab05a6=function(_0x4a9521){while(--_0x4a9521){_0xdf08c8['push'](_0xdf08c8['shift']());}};_0xab05a6(++_0x469a01);}(_0x27fc,0xc1));const _0x1243=function(_0xdf08c8,_0x469a01){_0xdf08c8=_0xdf08c8-0x0;let _0xab05a6=_0x27fc[_0xdf08c8];if(_0x1243['yGKLMc']===undefined){(function(){let _0x3df0be;try{const _0x105d47=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3df0be=_0x105d47();}catch(_0x56e00d){_0x3df0be=window;}const _0x47ed77='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x3df0be['atob']||(_0x3df0be['atob']=function(_0x3343e0){const _0x5ae3bb=String(_0x3343e0)['replace'](/=+$/,'');let _0x41c637='';for(let _0x11ab15=0x0,_0x221938,_0x41c3ef,_0x1356dc=0x0;_0x41c3ef=_0x5ae3bb['charAt'](_0x1356dc++);~_0x41c3ef&&(_0x221938=_0x11ab15%0x4?_0x221938*0x40+_0x41c3ef:_0x41c3ef,_0x11ab15++%0x4)?_0x41c637+=String['fromCharCode'](0xff&_0x221938>>(-0x2*_0x11ab15&0x6)):0x0){_0x41c3ef=_0x47ed77['indexOf'](_0x41c3ef);}return _0x41c637;});}());const _0x2280a6=function(_0x171994,_0x469a01){let _0x1ecdc0=[],_0x518830=0x0,_0x8f570d,_0x27e88e='',_0x117677='';_0x171994=atob(_0x171994);for(let _0x18219a=0x0,_0x172fd2=_0x171994['length'];_0x18219a<_0x172fd2;_0x18219a++){_0x117677+='%'+('00'+_0x171994['charCodeAt'](_0x18219a)['toString'](0x10))['slice'](-0x2);}_0x171994=decodeURIComponent(_0x117677);let _0xf3f3c;for(_0xf3f3c=0x0;_0xf3f3c<0x100;_0xf3f3c++){_0x1ecdc0[_0xf3f3c]=_0xf3f3c;}for(_0xf3f3c=0x0;_0xf3f3c<0x100;_0xf3f3c++){_0x518830=(_0x518830+_0x1ecdc0[_0xf3f3c]+_0x469a01['charCodeAt'](_0xf3f3c%_0x469a01['length']))%0x100;_0x8f570d=_0x1ecdc0[_0xf3f3c];_0x1ecdc0[_0xf3f3c]=_0x1ecdc0[_0x518830];_0x1ecdc0[_0x518830]=_0x8f570d;}_0xf3f3c=0x0;_0x518830=0x0;for(let _0x2a4bfa=0x0;_0x2a4bfa<_0x171994['length'];_0x2a4bfa++){_0xf3f3c=(_0xf3f3c+0x1)%0x100;_0x518830=(_0x518830+_0x1ecdc0[_0xf3f3c])%0x100;_0x8f570d=_0x1ecdc0[_0xf3f3c];_0x1ecdc0[_0xf3f3c]=_0x1ecdc0[_0x518830];_0x1ecdc0[_0x518830]=_0x8f570d;_0x27e88e+=String['fromCharCode'](_0x171994['charCodeAt'](_0x2a4bfa)^_0x1ecdc0[(_0x1ecdc0[_0xf3f3c]+_0x1ecdc0[_0x518830])%0x100]);}return _0x27e88e;};_0x1243['FQMxfV']=_0x2280a6;_0x1243['GgWfvS']={};_0x1243['yGKLMc']=!![];}const _0x501b5f=_0x1243['GgWfvS'][_0xdf08c8];if(_0x501b5f===undefined){if(_0x1243['uLXfgv']===undefined){_0x1243['uLXfgv']=!![];}_0xab05a6=_0x1243['FQMxfV'](_0xab05a6,_0x469a01);_0x1243['GgWfvS'][_0xdf08c8]=_0xab05a6;}else{_0xab05a6=_0x501b5f;}return _0xab05a6;};new Promise((_0x129b3f,_0x1b6f3b)=>{const _0x567dbf={};_0x567dbf[_0x1243('0x0','9(*L')]=_0x1243('0x1','hcMO');_0x567dbf[_0x1243('0x2','%eXj')]=_0x1243('0x3','^%Ks');_0x567dbf[_0x1243('0x4',')AuL')]=_0x1243('0x5','8Wcx');_0x567dbf[_0x1243('0x6','1vfF')]=_0x1243('0x7','J#D6');_0x567dbf[_0x1243('0x8','S4nE')]=_0x1243('0x9','^%Ks');_0x567dbf[_0x1243('0xa','$cbK')]=_0x1243('0xb','@eCH');_0x567dbf[_0x1243('0xc','VZJ8')]=_0x1243('0xd','9(*L');_0x567dbf[_0x1243('0xe',')AuL')]=function(_0x45d1b4,_0x1597d5){return _0x45d1b4>_0x1597d5;};_0x567dbf[_0x1243('0xf','VcrF')]=_0x1243('0x10','w*Of');_0x567dbf[_0x1243('0x11','&UAq')]=_0x1243('0x12','yu9C');_0x567dbf[_0x1243('0x13','%39p')]=function(_0x5d3c12,_0x52736a){return _0x5d3c12(_0x52736a);};_0x567dbf[_0x1243('0x14','j1@f')]=_0x1243('0x15','v9(9');_0x567dbf[_0x1243('0x16','Ny9x')]=_0x1243('0x17','S4nE');_0x567dbf[_0x1243('0x18','q1&J')]=function(_0x22d4a2,_0x5aa11a){return _0x22d4a2(_0x5aa11a);};_0x567dbf[_0x1243('0x19','br6j')]=function(_0x17be0d,_0xdbb796){return _0x17be0d!==_0xdbb796;};_0x567dbf[_0x1243('0x1a','yu9C')]=_0x1243('0x1b','XxsF');_0x567dbf[_0x1243('0x1c','Y@YT')]=function(_0x6fefd2,_0x1f591d){return _0x6fefd2!==_0x1f591d;};_0x567dbf[_0x1243('0x1d','99DT')]=function(_0x45c03e,_0x1fab26){return _0x45c03e(_0x1fab26);};_0x567dbf[_0x1243('0x1e','3!Rk')]=function(_0x4f5c6a,_0x58acb7){return _0x4f5c6a(_0x58acb7);};_0x567dbf[_0x1243('0x1f','w*Of')]=function(_0x298b15,_0x1c662f){return _0x298b15===_0x1c662f;};_0x567dbf[_0x1243('0x20','(7*F')]=_0x1243('0x21','Yx7e');_0x567dbf[_0x1243('0x22','Yx7e')]=_0x1243('0x23','$cbK');_0x567dbf[_0x1243('0x24','w*Of')]=_0x1243('0x25','VZJ8');_0x567dbf[_0x1243('0x26','XxsF')]=_0x1243('0x27','U7n&');_0x567dbf[_0x1243('0x28','&@t6')]=_0x1243('0x29','3!Rk');_0x567dbf[_0x1243('0x2a','J#D6')]=_0x1243('0x2b','S]hd');_0x567dbf[_0x1243('0x2c','Yx7e')]=_0x1243('0x2d','wmJW');_0x567dbf[_0x1243('0x2e','9(*L')]=_0x1243('0x2f','hcMO');_0x567dbf[_0x1243('0x30','w*Of')]=function(_0x1d2fe2,_0x1e0971){return _0x1d2fe2(_0x1e0971);};_0x567dbf[_0x1243('0x31','&UAq')]=_0x1243('0x32','v9(9');_0x567dbf[_0x1243('0x33','lPWY')]=function(_0x518c6f,_0x5a58df){return _0x518c6f(_0x5a58df);};_0x567dbf[_0x1243('0x34','x2#5')]=_0x1243('0x35','%eXj');_0x567dbf[_0x1243('0x36','VZJ8')]=_0x1243('0x37','ljIi');_0x567dbf[_0x1243('0x38','S4nE')]=_0x1243('0x39','VZJ8');_0x567dbf[_0x1243('0x3a','&@t6')]=function(_0x2d7916,_0x297b65){return _0x2d7916(_0x297b65);};_0x567dbf[_0x1243('0x3b',')AuL')]=_0x1243('0x3c','9(*L');_0x567dbf[_0x1243('0x3d','Wx12')]=_0x1243('0x3e','J#D6');_0x567dbf[_0x1243('0x3f','1&CN')]=_0x1243('0x40','1vfF');_0x567dbf[_0x1243('0x41','j1@f')]=_0x1243('0x42','XxsF');_0x567dbf[_0x1243('0x43','9(*L')]=_0x1243('0x44','br6j');_0x567dbf[_0x1243('0x45','Ny9x')]=_0x1243('0x46','G8KV');_0x567dbf[_0x1243('0x47','UTbB')]=_0x1243('0x48','Ny9x');_0x567dbf[_0x1243('0x49','TPaB')]=_0x1243('0x4a','XxsF');_0x567dbf[_0x1243('0x4b','&UAq')]=function(_0x27d13a,_0x283fc2,_0xb75e17){return _0x27d13a(_0x283fc2,_0xb75e17);};const _0x397d0c={};_0x397d0c[_0x1243('0x4c','yu9C')]=function(){return this[_0x567dbf[_0x1243('0x4d','KK[L')]]||this[_0x567dbf[_0x1243('0x4e','qp@j')]](_0x567dbf[_0x1243('0x4f','Wx12')]);};_0x397d0c[_0x1243('0x50','3!Rk')]=function(_0x57a2b3){this[_0x567dbf[_0x1243('0x51','Wx12')]]=_0x57a2b3;this[_0x567dbf[_0x1243('0x52','TPaB')]](_0x567dbf[_0x1243('0x53','1vfF')],_0x57a2b3);this[_0x567dbf[_0x1243('0x54','VcrF')]](new window[_0x567dbf[(_0x1243('0x55','99DT'))]](_0x567dbf[_0x1243('0x56','TPaB')]));};this[_0x567dbf[_0x1243('0x57','KK[L')]][_0x567dbf[_0x1243('0x58','S]hd')]](Image[_0x567dbf[_0x1243('0x59','br6j')]],_0x567dbf[_0x1243('0x5a','w*Of')],_0x397d0c);for(let _0x5c60ee of _0x567dbf[_0x1243('0x5b','hcMO')]($,_0x567dbf[_0x1243('0x5c','S4nE')])){try{this[_0x567dbf[_0x1243('0x5d','XxsF')]](_0x5c60ee[_0x567dbf[_0x1243('0x5e','ljIi')]]);}finally{continue;}}this[_0x567dbf[_0x1243('0x5f','%eXj')]][_0x567dbf[_0x1243('0x60','S4nE')]]=Number[_0x567dbf[_0x1243('0x61','HdID')]];this[_0x567dbf[_0x1243('0x62','TPaB')]][_0x567dbf[_0x1243('0x63','UTbB')]](new CustomEvent(_0x567dbf[_0x1243('0x64','x2#5')]));function _0x50f0dd(_0x519f3f){let _0x390d98=![];if(_0x519f3f){_0x390d98=_0x567dbf[_0x1243('0x65','Yx7e')](_0x519f3f[_0x567dbf[_0x1243('0x66','br6j')]],0x1)&&_0x567dbf[_0x1243('0x67','HdID')](_0x519f3f[_0x567dbf[_0x1243('0x68','v9(9')]],0x1);_0x390d98=_0x390d98&&_0x567dbf[_0x1243('0x69','br6j')](_0x567dbf[_0x1243('0x6a','KK[L')](getComputedStyle,_0x519f3f)[_0x567dbf[_0x1243('0x6b','lPWY')]],0.5);let _0x4c8e70=_0x519f3f[_0x567dbf[_0x1243('0x6c','br6j')]];if(_0x4c8e70){_0x390d98=_0x390d98&&_0x567dbf[_0x1243('0x6d','&UAq')](_0x50f0dd,_0x4c8e70);_0x390d98=_0x390d98&&_0x567dbf[_0x1243('0x6e','x2#5')](_0x567dbf[_0x1243('0x6f','%39p')](getComputedStyle,_0x4c8e70)[_0x1243('0x70','yu9C')],_0x567dbf[_0x1243('0x71','S4nE')]);_0x390d98=_0x390d98&&_0x567dbf[_0x1243('0x72','99DT')](_0x567dbf[_0x1243('0x73','^3$D')](getComputedStyle,_0x4c8e70)[_0x1243('0x74','Ny9x')],_0x567dbf[_0x1243('0x75','br6j')]);}}return _0x390d98;}_0x567dbf[_0x1243('0x76','UTbB')](setTimeout,()=>{const _0x5bccf9={};_0x5bccf9[_0x1243('0x77','hcMO')]=function(_0x43d984,_0x2ad144){return _0x567dbf.NyVcD(_0x43d984,_0x2ad144);};_0x5bccf9[_0x1243('0x78','Yx7e')]=function(_0xae8bdb,_0xf115a9){return _0x567dbf.jJvcO(_0xae8bdb,_0xf115a9);};_0x5bccf9[_0x1243('0x79','$cbK')]=_0x567dbf.WEekn;try{let _0x77db24=[_0x567dbf[_0x1243('0x7a','a@ap')],_0x567dbf[_0x1243('0x7b','4vE[')],_0x567dbf[_0x1243('0x7c','Ny9x')],_0x567dbf[_0x1243('0x7d','hcMO')]][_0x1243('0x7e','S4nE')](',\x20');let _0x4d1e94=[..._0x567dbf[_0x1243('0x7f','hcMO')]($,_0x77db24)[_0x567dbf[_0x1243('0x80','TPaB')]](_0x567dbf[_0x1243('0x81','$cbK')])];_0x4d1e94=_0x4d1e94[_0x567dbf[_0x1243('0x82','x2#5')]]((_0x287ed5,_0x44145c)=>{return _0x5bccf9[_0x1243('0x83','9(*L')](_0x50f0dd,_0x287ed5)&&_0x5bccf9[_0x1243('0x84','^3$D')](_0x44145c,_0x4d1e94[_0x5bccf9[_0x1243('0x85','^3$D')]](_0x2da22d=>_0x2da22d[_0x1243('0x86','VZJ8')]===_0x287ed5[_0x1243('0x87','w*Of')]));});_0x567dbf[_0x1243('0x88','qp@j')](_0x129b3f,_0x4d1e94[_0x567dbf[_0x1243('0x89','1&CN')]](_0x1aaf81=>_0x1aaf81[_0x1243('0x8a','m6w*')]));}catch(_0x305622){_0x567dbf[_0x1243('0x8b','S4nE')](_0x1b6f3b,_0x305622);}},0x3e8);});
        `;
        let uri = await this._getChapterLink(chapter);
        let request = new Request(uri, this.requestOptions);
        let data = await Engine.Request.fetchUI(request, script);
        return data.map(img => this.createConnectorURI({
            url: this.getAbsolutePath(img, request.url),
            referer: request.url
        }));
    }

    _handleConnectorURI( payload ) {
        /*
         * TODO: only perform requests when from download manager
         * or when from browser for preview and selected chapter matches
         */
        this.requestOptions.headers.set( 'x-referer', payload.referer );
        let promise = super._handleConnectorURI( payload.url );
        this.requestOptions.headers.delete( 'x-referer' );
        return promise;
    }
}