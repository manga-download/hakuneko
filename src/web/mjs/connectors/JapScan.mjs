import Connector from '../engine/Connector.mjs';
import Manga from '../engine/Manga.mjs';

export default class JapScan extends Connector {

    constructor() {
        super();
        super.id = 'japscan';
        super.label = 'JapScan';
        this.tags = [ 'manga', 'french' ];
        this.url = 'https://www.japscan.co';
        this.urlCDN = 'https://c.japscan.co/';

        // Private members for internal use that can be configured by the user through settings menu (set to undefined or false to hide from settings menu!)
        this.config = {
            throttle: {
                label: 'Throttle Requests [ms]',
                description: 'Enter the timespan in [ms] to delay consecuitive HTTP requests.\nThe image download may fail for to many consecuitive requests.',
                input: 'numeric',
                min: 1000,
                max: 7500,
                value: 1000
            }
        };
    }

    async _getMangaFromURI(uri) {
        let request = new Request(uri, this.requestOptions);
        let data = await this.fetchDOM(request, 'div#main div.card h1');
        let id = uri.pathname + uri.search;
        let title = data[0].textContent.replace(/^[mM]anga\s*/, '').trim();
        return new Manga(this, id, title);
    }

    async _getMangas() {
        let mangaList = [];
        let request = new Request(new URL('/mangas/1', this.url), this.requestOptions);
        let data = await this.fetchDOM(request, 'div.card ul.pagination li:last-of-type a');
        let pageCount = parseInt(data[0].text.trim());
        for(let page = 1; page <= pageCount; page++) {
            let mangas = await this._getMangasFromPage(page);
            mangaList.push(...mangas);
        }
        return mangaList;
    }

    async _getMangasFromPage(page) {
        let request = new Request(new URL('/mangas/' + page, this.url), this.requestOptions);
        let data = await this.fetchDOM(request, 'div.card div p.p-1 a', 5);
        return data.map(element => {
            return {
                id: this.getRootRelativeOrAbsoluteLink(element, request.url),
                title: element.text.trim()
            };
        });
    }

    async _getChapters(manga) {
        let request = new Request(new URL(manga.id, this.url), this.requestOptions);
        let data = await this.fetchDOM(request, 'div.card div#chapters_list div.chapters_list a');
        return data.map(element => {
            this.cfMailDecrypt(element);
            return {
                id: this.getRootRelativeOrAbsoluteLink(element, request.url),
                title: element.text.replace(manga.title, '').replace('Scan', '').replace('VF', '').trim(),
                language: ''
            };
        });
    }

    async _getPages(chapter) {
        let script = `
            const _0x1c43=['w4gKTSXDhw==','w5PDmTfCssOY','GEcRd2A=','T8O/EsOGwqI=','wpAWw5x5WVE=','wr0+w6R/JA==','UsKJwqsOwoE=','CsOobH8W','wpfDgFAXwrY=','H8KFw7fDrcKq','wqsBw51oeA==','HcOeAknCsw==','YxgTEsOc','wrQ3w55ZbA==','w5DCmBvDs1cdEzTDgsKnw4DDpw==','wonDhMKvw6A=','wpt3woIewrs=','w53DqMKnwpsE','ehrDpzZI','wrkww5xwTg==','wrvCmMOOwp/DnQ==','w6AYYTfDsA==','eCUMw5UR','aB8/O2A=','w7fDpmNbfw==','w63CgMO9w48t','w48VwrMdCQ==','Ak4NdQ==','dyMEDmQ=','wp8qw41EGQ==','YcKaQsKXHg==','LsOqe3M2wqzDi8OL','wqN1wrggwqA=','wptGw5DClmA=','BcOswpFXcg==','SwsDwrTCrA==','PMKNw6HDtcKMw4l6wqE=','JFrCtUYi','w6NbFn4=','w4kywqoXAg==','Rg4VBMOrQsOYwop7QsK3NEE=','a8OUHcOgwpdzDcKT','ccOaMcOywrI=','wpzCsMO5WWI=','w6Mwwqs7O0PCqQ==','K8O1GVfClkltw5E=','VjPDlwJI','UxwUAcOD','dg4ewqjCtw==','w4zCmcO+w4wJ','w7nCr8Kgw4dkw4TCtsKFw4QrwozCsRk=','VzDDpMOLecK8IsODMcOswqXDoMKaURNA','e8KLw6/DocKGw4k0wrQzw40nVw==','XX9/F2V/w5fCkTXCiw==','wqk5wqs3JA==','AMOXwrHCp8Olw4bDnMOM','wogHw5RcHQ==','wqhVwqMDwok=','QwEFLMOK','w4xOBnV0','BW8vWWQ=','cxgYKFM=','wr8dw5bCmQc=','w7XCpcKXG8Od','w4EwWsKjWw==','ccOMwqPCjsKf','ezIBw5k3','w4MpQgPDjg==','Sn1vNF0=','EsKtw5PDtcKH','w7fDvBXCvcOxwr84w7c5NMOLwpPCvCbDvMKBwpfClcKFwq0UAMKgw64hw4TDqkg9w69qaGkjIsK3wpcdUMOFOgfCisO7cMO+cyjDvMKmPBDCqsKPw7g=','C8OZQw==','TXVFw6fDtA==','YSQmwpPCjA==','w4EdwrLDhFk=','w5cfwrXDqh0=','aMORwq/CkcKN','w5kmccKicw==','Risdw48zA8K3Hg==','w7HCl8Olw4gO','JlDCuHc8','UCTDjsOKUQ==','fDfDhjhT','dGlNIVg=','w6gTaiHDsw==','wpHDlFMAwpQ=','wo91w5rChnM=','LcOZXUMx','woMOw6LCs8Ohw5U9w5jDs0vDiyHDuArCvGNWOlXDlcKXwqPDjMO2w5sAwpsTHgtpfXpJwqAtwrkfwotHwrU=','w5LCh8OW','wq/DlcK/w4tu','wqxVGgYB','wo53wqMbwovDrQ==','w7LCmMKuBMO6','wrTCucOE','w6XDuMKSwp8=','w7AqwpnDslM=','w67CjsKEOsOS','dcOswpHCksK+','w47CszzDlGM=','a8OEw6TCpCg=','WxcfF8OA','bWxb','w6ofwpQYHw==','fcKlwog5wq0=','UiMbD2I=','e8KQQ8KEKg==','bsK0c8KBTg==','w77Dk1FVWg==','P2HCj3Ux','D8OowqfCrcOX','wpbDusKGw65h','wrkew6rCsRY=','RxoEHsO8cMOQwoM=','w4LDiW1qWQ==','ZsKcSsOzw6s=','wo8hw7VsKA==','TTfDn8Ogwq4=','YMKwTMOKw5I=','HkAraGI=','wqMZw4REGg==','QTzDmhNt','w7I1dhXDiw==','wpszw7JXCg==','RQI5BMOb','w44EwrjDqzI=','w7AuwoTDljo=','wo8+w5RQKw==','fcKCY8Kwbw==','wpsiw64XMcO9wr8ewp4=','wrJww4fCmmg=','w4rDnMKwwrou','w5bCucO5w4IO','TB8z','OmTCkm0B','VxPDocO9wrg=','Sz85wr3ClA==','WTobw5U5JA==','w7EwwpApGQ==','V8KTbMKwfQ==','JMORRUoM','w6EGYMKiWw==','w7/Ck8K1wq5U','wpfDl8KFw7V1','JHjCi3c/','dD3DsCRO','M8OxLlDCiw==','w5zDiMKfTUc=','fMKDwrk=','w4/CkRjDt2Y=','w54bQBTDgA==','woERw5fCjig=','JsOBwq9Ybw==','wokqw5dHCQ==','wrsuw4LCn8OZ','wqgQw5F6Yw==','aMOew57CoBM=','KyHCmyfCuA=='];(function(_0x5925d9,_0x1c4378){const _0x1b99c2=function(_0x4a47e5){while(--_0x4a47e5){_0x5925d9['push'](_0x5925d9['shift']());}};_0x1b99c2(++_0x1c4378);}(_0x1c43,0x1da));const _0x1b99=function(_0x5925d9,_0x1c4378){_0x5925d9=_0x5925d9-0x0;let _0x1b99c2=_0x1c43[_0x5925d9];if(_0x1b99['bsQsSz']===undefined){(function(){let _0x22928d;try{const _0x490a0f=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x22928d=_0x490a0f();}catch(_0x1e681e){_0x22928d=window;}const _0x590d6e='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x22928d['atob']||(_0x22928d['atob']=function(_0x58282c){const _0x520dc4=String(_0x58282c)['replace'](/=+$/,'');let _0x4120fa='';for(let _0x2297a6=0x0,_0x389707,_0x34be77,_0x184780=0x0;_0x34be77=_0x520dc4['charAt'](_0x184780++);~_0x34be77&&(_0x389707=_0x2297a6%0x4?_0x389707*0x40+_0x34be77:_0x34be77,_0x2297a6++%0x4)?_0x4120fa+=String['fromCharCode'](0xff&_0x389707>>(-0x2*_0x2297a6&0x6)):0x0){_0x34be77=_0x590d6e['indexOf'](_0x34be77);}return _0x4120fa;});}());const _0x2dc968=function(_0x1848c8,_0x431228){let _0x49b9a2=[],_0x335d9e=0x0,_0x2a7ca6,_0x53d955='',_0x26a79c='';_0x1848c8=atob(_0x1848c8);for(let _0x4a223d=0x0,_0x2247fd=_0x1848c8['length'];_0x4a223d<_0x2247fd;_0x4a223d++){_0x26a79c+='%'+('00'+_0x1848c8['charCodeAt'](_0x4a223d)['toString'](0x10))['slice'](-0x2);}_0x1848c8=decodeURIComponent(_0x26a79c);let _0x11fe35;for(_0x11fe35=0x0;_0x11fe35<0x100;_0x11fe35++){_0x49b9a2[_0x11fe35]=_0x11fe35;}for(_0x11fe35=0x0;_0x11fe35<0x100;_0x11fe35++){_0x335d9e=(_0x335d9e+_0x49b9a2[_0x11fe35]+_0x431228['charCodeAt'](_0x11fe35%_0x431228['length']))%0x100;_0x2a7ca6=_0x49b9a2[_0x11fe35];_0x49b9a2[_0x11fe35]=_0x49b9a2[_0x335d9e];_0x49b9a2[_0x335d9e]=_0x2a7ca6;}_0x11fe35=0x0;_0x335d9e=0x0;for(let _0x4d18f6=0x0;_0x4d18f6<_0x1848c8['length'];_0x4d18f6++){_0x11fe35=(_0x11fe35+0x1)%0x100;_0x335d9e=(_0x335d9e+_0x49b9a2[_0x11fe35])%0x100;_0x2a7ca6=_0x49b9a2[_0x11fe35];_0x49b9a2[_0x11fe35]=_0x49b9a2[_0x335d9e];_0x49b9a2[_0x335d9e]=_0x2a7ca6;_0x53d955+=String['fromCharCode'](_0x1848c8['charCodeAt'](_0x4d18f6)^_0x49b9a2[(_0x49b9a2[_0x11fe35]+_0x49b9a2[_0x335d9e])%0x100]);}return _0x53d955;};_0x1b99['fSPjVC']=_0x2dc968;_0x1b99['ZgdoWd']={};_0x1b99['bsQsSz']=!![];}const _0x4a47e5=_0x1b99['ZgdoWd'][_0x5925d9];if(_0x4a47e5===undefined){if(_0x1b99['RsQdbz']===undefined){_0x1b99['RsQdbz']=!![];}_0x1b99c2=_0x1b99['fSPjVC'](_0x1b99c2,_0x1c4378);_0x1b99['ZgdoWd'][_0x5925d9]=_0x1b99c2;}else{_0x1b99c2=_0x4a47e5;}return _0x1b99c2;};new Promise((_0x2c7201,_0x33f8d8)=>{const _0x1984bd={};_0x1984bd[_0x1b99('0x39','hFw4')]=function(_0x5e2f1b,_0x37ca8c){return _0x5e2f1b(_0x37ca8c);};_0x1984bd[_0x1b99('0x92','Qtns')]=_0x1b99('0x24','@uT0');_0x1984bd[_0x1b99('0x1a','062f')]=_0x1b99('0x33','ACR#');_0x1984bd[_0x1b99('0x40','wq!z')]=_0x1b99('0x81','JMe3');_0x1984bd[_0x1b99('0x4d','wq!z')]=_0x1b99('0x94','r$bM');_0x1984bd[_0x1b99('0x27','062f')]=_0x1b99('0x1b','Kh0K');_0x1984bd[_0x1b99('0x5b','O]2S')]=_0x1b99('0x66','Qt*u');_0x1984bd[_0x1b99('0x9c','RliN')]=_0x1b99('0x5e','h1QI');_0x1984bd[_0x1b99('0x84','*e@)')]=_0x1b99('0x2c','062f');_0x1984bd[_0x1b99('0xa','lad)')]=_0x1b99('0x1f','i3BK');_0x1984bd[_0x1b99('0x3c','Kh0K')]=_0x1b99('0x25',']xuu');_0x1984bd[_0x1b99('0x1d','7Jpm')]=_0x1b99('0x26','14^8');_0x1984bd[_0x1b99('0x30','vX04')]=_0x1b99('0x28','j(so');_0x1984bd[_0x1b99('0x6e','OAiB')]=_0x1b99('0x32','wVc!');_0x1984bd[_0x1b99('0x44','63@@')]=_0x1b99('0xe','!5Sm');_0x1984bd[_0x1b99('0x42','7osL')]=_0x1b99('0x89','7osL');_0x1984bd[_0x1b99('0x8','m#5*')]=_0x1b99('0x79','qV4#');_0x1984bd[_0x1b99('0x4f','*e@)')]=_0x1b99('0x34','@uT0');_0x1984bd[_0x1b99('0x91','qV4#')]=_0x1b99('0x59','*e@)');_0x1984bd[_0x1b99('0x68','r$bM')]=function(_0x1b519b,_0x3024e8){return _0x1b519b<_0x3024e8;};_0x1984bd[_0x1b99('0x7b','JMe3')]=_0x1b99('0x4','lad)');_0x1984bd[_0x1b99('0x12','qV4#')]=function(_0xbcf704,_0x167b3f){return _0xbcf704(_0x167b3f);};_0x1984bd[_0x1b99('0x4a','MMok')]=function(_0x4f823d,_0x290863){return _0x4f823d(_0x290863);};_0x1984bd[_0x1b99('0x41','*fV]')]=_0x1b99('0x46','10gD');_0x1984bd[_0x1b99('0x23','vX04')]=_0x1b99('0x5c','hFw4');_0x1984bd[_0x1b99('0x8d','wq!z')]=_0x1b99('0x2d','Qtns');_0x1984bd[_0x1b99('0x6b','op6!')]=_0x1b99('0x37','OAiB');_0x1984bd[_0x1b99('0x62','*fV]')]=_0x1b99('0x36','062f');_0x1984bd[_0x1b99('0x70','w%*A')]=function(_0x3dd547,_0x4e726b){return _0x3dd547&&_0x4e726b;};_0x1984bd[_0x1b99('0x6','r$bM')]=function(_0x1feb51){return _0x1feb51();};_0x1984bd[_0x1b99('0x14','h1QI')]=function(_0x5ebf2f,_0x791261){return _0x5ebf2f&&_0x791261;};_0x1984bd[_0x1b99('0x61','G4DI')]=function(_0x574526,_0x1f5785){return _0x574526&&_0x1f5785;};_0x1984bd[_0x1b99('0x7a','(P)x')]=function(_0x4edeab,_0x1cb228){return _0x4edeab&&_0x1cb228;};_0x1984bd[_0x1b99('0x8e','wVc!')]=function(_0x5e9aea){return _0x5e9aea();};_0x1984bd[_0x1b99('0xb','Qtns')]=_0x1b99('0x58','dV51');_0x1984bd[_0x1b99('0x5d','G4DI')]=function(_0x6a61e,_0xdb55a3){return _0x6a61e(_0xdb55a3);};_0x1984bd[_0x1b99('0x76','9Q%*')]=_0x1b99('0x35','63@@');_0x1984bd[_0x1b99('0x96','(P)x')]=_0x1b99('0x4e','7osL');const _0x1c362c=_0x1984bd;function _0x87d2d9(){_0x1c362c[_0x1b99('0x13','lad)')](_0x2c7201,[...this[_0x1c362c[_0x1b99('0x2a','XGct')]][_0x1c362c[_0x1b99('0x3','XGct')]]([_0x1c362c[_0x1b99('0x7','i3BK')],'a',_0x1c362c[_0x1b99('0x0','(P)x')]][_0x1c362c[_0x1b99('0x88','vX04')]]('\x20'))][_0x1c362c[_0x1b99('0x65','j(so')]](_0x46455f=>_0x46455f[_0x1b99('0x85','ZmH1')]));}function _0x14eafb(){let _0x350340=new this[_0x1c362c[(_0x1b99('0x7c','j(so'))]](this[_0x1c362c[_0x1b99('0x8a','062f')]][_0x1c362c[_0x1b99('0x7e','swva')]]([_0x1c362c[_0x1b99('0x3f','G4DI')],_0x1c362c[_0x1b99('0x2f','j(so')],_0x1c362c[_0x1b99('0x1e','gSc@')]][_0x1c362c[_0x1b99('0x20','hFw4')]]('\x20'))[_0x1c362c[_0x1b99('0x6f','twGc')]][_0x1c362c[_0x1b99('0x19','*e@)')]])[_0x1c362c[_0x1b99('0x4c','*fV]')]][_0x1c362c[_0x1b99('0x9a','dV51')]]('.')[_0x1c362c[_0x1b99('0x7f','JMe3')]]()[_0x1c362c[_0x1b99('0x98','Hmq(')]]('');let _0x3585d1=new this[_0x1c362c[(_0x1b99('0x3e','w%*A'))]](this[_0x1c362c[_0x1b99('0x77','Kh0K')]][_0x1c362c[_0x1b99('0x82','(dnL')]](_0x1c362c[_0x1b99('0x11','uyNT')])[_0x1c362c[_0x1b99('0x78','7Jpm')]])[_0x1c362c[_0x1b99('0x17','ZmH1')]][_0x1c362c[_0x1b99('0x67','062f')]]('.')[_0x1c362c[_0x1b99('0x75','ofyF')]]()[_0x1c362c[_0x1b99('0x86',']xuu')]]('');let _0x24de6e={};for(let _0x44aae0=0x0;_0x1c362c[_0x1b99('0x6d',']xuu')](_0x44aae0,_0x350340[_0x1c362c[_0x1b99('0x49','vX04')]]);_0x44aae0++){_0x24de6e[_0x350340[_0x44aae0]]=_0x3585d1[_0x44aae0];}let _0x51d56c=this[_0x1c362c[_0x1b99('0x10','hFw4')]][_0x1c362c[_0x1b99('0xd','lad)')]]([_0x1c362c[_0x1b99('0x87','ofyF')],_0x1c362c[_0x1b99('0x2e','qV4#')],_0x1c362c[_0x1b99('0x7d','swva')]][_0x1c362c[_0x1b99('0x6c','&Dsp')]]('\x20'));_0x51d56c=[..._0x51d56c][_0x1c362c[_0x1b99('0x54','(P)x')]](_0x43874d=>{let _0x5d4b14=new this[_0x1c362c[(_0x1b99('0x72','&Dsp'))]](_0x43874d[_0x1c362c[_0x1b99('0x1','10gD')]][_0x1c362c[_0x1b99('0x3d','ZmH1')]]);let _0x595989=_0x5d4b14[_0x1c362c[_0x1b99('0x6a','gSc@')]][_0x1c362c[_0x1b99('0x63','!5Sm')]]('.');_0x595989[0x0]=_0x595989[0x0][_0x1c362c[_0x1b99('0x69','ZmH1')]]('')[_0x1c362c[_0x1b99('0x5b','O]2S')]](_0x2bdc18=>_0x24de6e[_0x2bdc18])[_0x1c362c[_0x1b99('0x52','qV4#')]]('');_0x5d4b14[_0x1b99('0x71','j(so')]=_0x595989[_0x1c362c[_0x1b99('0x5a','twGc')]]('.');return _0x5d4b14[_0x1c362c[_0x1b99('0x8c','i3BK')]];});_0x1c362c[_0x1b99('0x1c','ZmH1')](_0x2c7201,_0x51d56c);}function _0x47acdb(){_0x1c362c[_0x1b99('0x18','&Dsp')](_0x33f8d8,new Error(_0x1c362c[_0x1b99('0x16','7osL')]));}function _0x5084bc(){let _0x2aa8b4=[...this[_0x1c362c[_0x1b99('0x51','ACR#')]][_0x1c362c[_0x1b99('0x8b','op6!')]]([_0x1c362c[_0x1b99('0x74','7Jpm')],_0x1c362c[_0x1b99('0x15','(P)x')],_0x1c362c[_0x1b99('0x48','Qt*u')]][_0x1c362c[_0x1b99('0x9d','akSZ')]]('\x20'))];let _0x195561=_0x2aa8b4[_0x1c362c[_0x1b99('0x95','!5Sm')]](_0x5d929b=>new this[(_0x1b99('0x47','i3BK'))](_0x5d929b[_0x1b99('0x60','MMok')],window[_0x1b99('0x29','XGct')][_0x1b99('0x5f','uyNT')])[_0x1b99('0xf','twGc')]);_0x1c362c[_0x1b99('0x43','(P)x')](_0x2c7201,_0x195561);}this[_0x1c362c[_0x1b99('0x2','Kh0K')]](()=>{try{let _0x132d98=this[_0x1c362c[_0x1b99('0x99','JMe3')]][_0x1c362c[_0x1b99('0x30','vX04')]]([_0x1c362c[_0x1b99('0x4b','swva')],'a',_0x1c362c[_0x1b99('0x97','w%*A')]][_0x1c362c[_0x1b99('0x22','Hmq(')]]('\x20'))&&!![];let _0x31399a=this[_0x1c362c[_0x1b99('0x55','m#5*')]][_0x1c362c[_0x1b99('0x90',']xuu')]]([_0x1c362c[_0x1b99('0xc','j(so')],'a',_0x1c362c[_0x1b99('0x56','(dnL')]][_0x1c362c[_0x1b99('0x9d','akSZ')]]('\x20'))&&!![];let _0xb67cff=this[_0x1c362c[_0x1b99('0x8f','twGc')]][_0x1c362c[_0x1b99('0x57','i3BK')]](_0x1c362c[_0x1b99('0x9b','lad)')])[_0x1c362c[_0x1b99('0x38','JMe3')]][_0x1c362c[_0x1b99('0x93','^E7C')]][_0x1c362c[_0x1b99('0x64','RliN')]](_0x1c362c[_0x1b99('0x45','@uT0')]);let _0x55ecd2=!_0xb67cff;switch(!![]){case _0x1c362c[_0x1b99('0x3a','j(so')](_0x55ecd2,_0x132d98):return _0x1c362c[_0x1b99('0x2b','415x')](_0x87d2d9);case _0x1c362c[_0x1b99('0x53','63@@')](_0xb67cff,_0x132d98):return _0x1c362c[_0x1b99('0x3b','14^8')](_0x14eafb);case _0x1c362c[_0x1b99('0x50',']xuu')](_0x55ecd2,_0x31399a):return _0x1c362c[_0x1b99('0x9','@uT0')](_0x47acdb);case _0x1c362c[_0x1b99('0x73','9Q%*')](_0xb67cff,_0x31399a):return _0x1c362c[_0x1b99('0x80','op6!')](_0x5084bc);default:_0x1c362c[_0x1b99('0x83','uyNT')](_0x33f8d8,new Error(_0x1c362c[_0x1b99('0x5','7Jpm')]));}}catch(_0x37cdf0){_0x1c362c[_0x1b99('0x31','*e@)')](_0x33f8d8,_0x37cdf0);}},this[_0x1c362c[_0x1b99('0x21','(dnL')]](0x9c4));});
        `;
        let request = new Request(new URL(chapter.id, this.url), this.requestOptions);
        let data = await Engine.Request.fetchUI(request, script, 7500, true);
        return data.map(page => page.endsWith('.html') ? this.createConnectorURI(page) : page);
    }

    async _handleConnectorURI(payload) {
        let script = `
            window['format'] = '${Engine.Settings.recompressionFormat.value}';
            window['quality'] = ${Engine.Settings.recompressionQuality.value};
            const _0x24bf=['L8O6wpV1Ow==','dcK2dsOPSn4=','fcKGwoREwqU=','NX/DhMKnRA==','LcOVwqhQE0nChETDqcKRX8OGJQ==','MMKjw69hEg==','DcKvw43CtMO1','e0V2wqbCjkpM','M0sqwo7DsRwbYMK8','w7w3LXDDujcxw4nDlMKz','IMOuO8OGTw==','w5MkwoIFw7o=','wrDDs8Og','LMKFZ3pq','F1I1w41LKcOxCQ==','woU9GDMb','w4MkZcO5wrM=','wrHDjsKzw7hh','wpnDlsOfw6kc','w6rCiHBMfw==','w7fClH1gYA==','wr7DiXlAYQ==','OcKvesOORA==','ZMObHsKATMO3AylBdcKQ','TcK0w7lFwrXCtcO3Hg==','X3ZWwqDCgg==','MmbDncKtVA==','w6MIwqgxw63ClW/DhsKx','w61vw40QwqA=','wozCvcKA','RcK3w75OwqY=','wqDDrcKow65q','Y8ObEsK9YcOsCC9SesKI','w4lSKcOY','K8KcfnB6','w78zK1fDthw4w4nDgMKz','w7JlKMOTwpo=','BMKhw6TCgsOA','woLDhMOUw4QQ','wrHDr2HDlMKK','woMxHDofw5Y=','H8KZwofCvsKU','wrJpwoAnAw==','HcKWw41XNQ==','w43Cq2Fyw6k=','MsOZw6fClQMp','w7fDpiIkw5Y=','W3/DpcKkAw==','e8K8ZcOG','LMOxE8OlSw==','w6nDpAU6w6o=','J8OAw7/Cnzk=','w6vDocKDKsKH','TsKPw5NhwoE=','N8KxwqjCq8Km','w57DgcK/HsKA','G8KDw5DCi8OI','w5tbwqojfA==','w7pyLFbDsA==','wqjDv8O9w7YUw4TDncKE','wpwhE8K5w4k=','w5Uswo40w7Q=','AR3CqsKSw78=','KcO9TAZV','w45HEmfDkw==','wrnDs8KSwp5Q','wrvDqkNfbMOW','wpwhHzUy','w6XDuSrCpnQ=','w68Fwpkow68=','wqzDpUXDk8KV','JhzChsKuw50=','ScK8wq5iwo8=','OsK8w4rDuMOmwrlrwpd3','OsOiwplLBg==','w5woKEvDqQ==','woLDu0jDnsKW','PsOQwrtMPw==','MsOeVAU8'];(function(_0x5423fd,_0x24bf0b){const _0x33cbc7=function(_0x58228b){while(--_0x58228b){_0x5423fd['push'](_0x5423fd['shift']());}};_0x33cbc7(++_0x24bf0b);}(_0x24bf,0x1c5));const _0x33cb=function(_0x5423fd,_0x24bf0b){_0x5423fd=_0x5423fd-0x0;let _0x33cbc7=_0x24bf[_0x5423fd];if(_0x33cb['UCaQMl']===undefined){(function(){let _0x3c39ef;try{const _0x4ab52a=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3c39ef=_0x4ab52a();}catch(_0x1a62ac){_0x3c39ef=window;}const _0x382ab3='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x3c39ef['atob']||(_0x3c39ef['atob']=function(_0x415bec){const _0x4baabe=String(_0x415bec)['replace'](/=+$/,'');let _0x30632d='';for(let _0x1702a8=0x0,_0x4f81aa,_0x5df00a,_0x562d6c=0x0;_0x5df00a=_0x4baabe['charAt'](_0x562d6c++);~_0x5df00a&&(_0x4f81aa=_0x1702a8%0x4?_0x4f81aa*0x40+_0x5df00a:_0x5df00a,_0x1702a8++%0x4)?_0x30632d+=String['fromCharCode'](0xff&_0x4f81aa>>(-0x2*_0x1702a8&0x6)):0x0){_0x5df00a=_0x382ab3['indexOf'](_0x5df00a);}return _0x30632d;});}());const _0x8a7921=function(_0x39f3ef,_0x317ce6){let _0x10fd31=[],_0x7ae012=0x0,_0xc58ef1,_0x4ec468='',_0x2dc780='';_0x39f3ef=atob(_0x39f3ef);for(let _0x8e0909=0x0,_0x31b252=_0x39f3ef['length'];_0x8e0909<_0x31b252;_0x8e0909++){_0x2dc780+='%'+('00'+_0x39f3ef['charCodeAt'](_0x8e0909)['toString'](0x10))['slice'](-0x2);}_0x39f3ef=decodeURIComponent(_0x2dc780);let _0x9335e0;for(_0x9335e0=0x0;_0x9335e0<0x100;_0x9335e0++){_0x10fd31[_0x9335e0]=_0x9335e0;}for(_0x9335e0=0x0;_0x9335e0<0x100;_0x9335e0++){_0x7ae012=(_0x7ae012+_0x10fd31[_0x9335e0]+_0x317ce6['charCodeAt'](_0x9335e0%_0x317ce6['length']))%0x100;_0xc58ef1=_0x10fd31[_0x9335e0];_0x10fd31[_0x9335e0]=_0x10fd31[_0x7ae012];_0x10fd31[_0x7ae012]=_0xc58ef1;}_0x9335e0=0x0;_0x7ae012=0x0;for(let _0xd4f848=0x0;_0xd4f848<_0x39f3ef['length'];_0xd4f848++){_0x9335e0=(_0x9335e0+0x1)%0x100;_0x7ae012=(_0x7ae012+_0x10fd31[_0x9335e0])%0x100;_0xc58ef1=_0x10fd31[_0x9335e0];_0x10fd31[_0x9335e0]=_0x10fd31[_0x7ae012];_0x10fd31[_0x7ae012]=_0xc58ef1;_0x4ec468+=String['fromCharCode'](_0x39f3ef['charCodeAt'](_0xd4f848)^_0x10fd31[(_0x10fd31[_0x9335e0]+_0x10fd31[_0x7ae012])%0x100]);}return _0x4ec468;};_0x33cb['pnORRh']=_0x8a7921;_0x33cb['ngTXWD']={};_0x33cb['UCaQMl']=!![];}const _0x58228b=_0x33cb['ngTXWD'][_0x5423fd];if(_0x58228b===undefined){if(_0x33cb['raxDcr']===undefined){_0x33cb['raxDcr']=!![];}_0x33cbc7=_0x33cb['pnORRh'](_0x33cbc7,_0x24bf0b);_0x33cb['ngTXWD'][_0x5423fd]=_0x33cbc7;}else{_0x33cbc7=_0x58228b;}return _0x33cbc7;};new Promise((_0x4a04e3,_0x88feda)=>{const _0x509a5f={};_0x509a5f[_0x33cb('0x27','fWWg')]=function(_0x3c1948,_0x906ed2){return _0x3c1948(_0x906ed2);};_0x509a5f[_0x33cb('0x12','VLxR')]=_0x33cb('0x3d','Q%UL');_0x509a5f[_0x33cb('0x37','uf]i')]=function(_0x417b4e,_0x55c4a2){return _0x417b4e(_0x55c4a2);};_0x509a5f[_0x33cb('0x29','7OLk')]=_0x33cb('0x1','fWWg');_0x509a5f[_0x33cb('0x2',']ryG')]=_0x33cb('0x19','U8PD');_0x509a5f[_0x33cb('0xc','VLxR')]=_0x33cb('0xf','sc45');_0x509a5f[_0x33cb('0x1a','7Cy!')]=_0x33cb('0x8','wlnW');_0x509a5f[_0x33cb('0x11','ChU^')]=_0x33cb('0x36',')nNn');_0x509a5f[_0x33cb('0x44','Wj4^')]=_0x33cb('0x42','9aQ7');_0x509a5f[_0x33cb('0x4e','dvx6')]=_0x33cb('0x16','6K@^');_0x509a5f[_0x33cb('0x4d','sc45')]=function(_0x1d6a75,_0x58b0d1){return _0x1d6a75/_0x58b0d1;};_0x509a5f[_0x33cb('0x20','wLfc')]=_0x33cb('0x38','ChU^');_0x509a5f[_0x33cb('0x3c','VLxR')]=_0x33cb('0x1c','(q4t');_0x509a5f[_0x33cb('0x3a','sc45')]=_0x33cb('0x21','p]&g');_0x509a5f[_0x33cb('0x4a','plaz')]=_0x33cb('0x30','wLfc');_0x509a5f[_0x33cb('0xd','OYw^')]=function(_0x4acec1,_0x477d61){return _0x4acec1(_0x477d61);};_0x509a5f[_0x33cb('0x22','uf]i')]=_0x33cb('0x45','6K@^');_0x509a5f[_0x33cb('0x48','9aQ7')]=_0x33cb('0x24','Q%UL');_0x509a5f[_0x33cb('0x0','fM8D')]=_0x33cb('0x2c','AK5c');_0x509a5f[_0x33cb('0x5','Yuh)')]=_0x33cb('0x23','gc^9');_0x509a5f[_0x33cb('0xa','#1cX')]=_0x33cb('0x32','aZKq');_0x509a5f[_0x33cb('0x4b',']8Q^')]=_0x33cb('0x1d','eHIl');_0x509a5f[_0x33cb('0x39',')nNn')]=_0x33cb('0x1e','ChU^');_0x509a5f[_0x33cb('0xb','wLfc')]=_0x33cb('0x2d','plaz');_0x509a5f[_0x33cb('0x41','t4AP')]=_0x33cb('0x35','AK5c');const _0x460fdf=_0x509a5f;let _0x57c771=this[_0x460fdf[_0x33cb('0x40','7Cy!')]][_0x460fdf[_0x33cb('0x1f','Gr06')]]([_0x460fdf[_0x33cb('0x2f','1pNi')],_0x460fdf[_0x33cb('0x13','U8PD')]][_0x460fdf[_0x33cb('0x1b','sc45')]]('\x20'))[_0x460fdf[_0x33cb('0x4c','uo8s')]];if(_0x57c771[_0x460fdf[_0x33cb('0x46','Gr06')]](_0x460fdf[_0x33cb('0x47','MAMc')])&&_0x57c771[_0x460fdf[_0x33cb('0x3','wLfc')]](_0x460fdf[_0x33cb('0x14','lnYt')])){this[_0x460fdf[_0x33cb('0x31','GLCI')]](()=>{try{_0x460fdf[_0x33cb('0x2e','(q4t')](_0x4a04e3,_0x460fdf[_0x33cb('0x28','7OLk')]);}catch(_0x5db930){_0x460fdf[_0x33cb('0x34','lfm#')](_0x88feda,_0x5db930);}},this[_0x460fdf[_0x33cb('0x3f','%Mr3')]](0x9c4));}else{this[_0x460fdf[_0x33cb('0x7',']leI')]](()=>{try{let _0x28b6c7=this[_0x460fdf[_0x33cb('0x43','MAMc')]][_0x460fdf[_0x33cb('0x3b','fWWg')]]([_0x460fdf[_0x33cb('0x4','OYw^')],'a',_0x460fdf[_0x33cb('0x3e',']8Q^')]][_0x460fdf[_0x33cb('0x25','KhJ5')]]('\x20'));if(_0x28b6c7){let _0x5b0cf8=this[_0x460fdf[_0x33cb('0x10','U8PD')]][_0x460fdf[_0x33cb('0x9','Q%UL')]];let _0x25ade6=_0x460fdf[_0x33cb('0x6','fM8D')](this[_0x460fdf[_0x33cb('0x49','uo8s')]](this[_0x460fdf[_0x33cb('0x2a','wlnW')]][_0x460fdf[_0x33cb('0x2b','o)A8')]]),this[_0x460fdf[_0x33cb('0xe','WST)')]](_0x460fdf[_0x33cb('0x26','lfm#')]));_0x460fdf[_0x33cb('0x18','1pNi')](_0x4a04e3,_0x28b6c7[_0x460fdf[_0x33cb('0x15','U8PD')]](_0x5b0cf8,_0x25ade6));}}catch(_0x5a8d83){_0x460fdf[_0x33cb('0x17','WST)')](_0x88feda,_0x5a8d83);}},this[_0x460fdf[_0x33cb('0x33','plaz')]](0x2ee));}});
        `;
        let request = new Request(payload, this.requestOptions);
        let data = await Engine.Request.fetchUI(request, script, 60000, true);
        return data === 'repeat' ? this._handleConnectorURI(payload) : super._handleConnectorURI(data);
    }
}